---
project:
  name: "Sabake_osakana - 魚さばきブロック崩し（Unity版）"
  description: "HTML5で作成したブロック崩しゲームをUnityで再現するプロジェクト"
  status: "開発中（マルチボール機能実装中）"
  created: 2025-11-29
  updated: 2026-01-09

# =============================================
# プロジェクト概要
# =============================================
overview:
  goal: "自然言語の指示だけでUnityゲームを作成する実験"
  # デバイス1 (元環境)
  unity_project: "C:\\Users\\user\\Documents\\Unity\\Projects\\Sabake_osakana"
  unity_project_wsl: "/mnt/c/Users/user/Documents/Unity/Projects/Sabake_osakana"
  # デバイス2 (新環境)
  unity_project_alt: "D:\\Unity\\Sabake_osakana"
  unity_project_wsl_alt: "/mnt/d/Unity/Sabake_osakana"

# =============================================
# 現在の状態
# =============================================
current_status:
  working:
    - "タイトル画面のUI表示（TextMeshPro）"
    - "ゲームプレイ（ブロック崩し基本動作）"
    - "魚画像マスク表示（脱衣ブロック崩し方式）"
    - "画像アルファからブロックパターン自動生成"
    - "リザルト画面（パーセント基準ランク表示）"
    - "ゲームオーバー画面"
    - "ポーズ機能"
    - "疎結合アーキテクチャ（GameEvents）"
    - "MCP経由でのUnity操作"
    - "色設定のCSV管理（ColorData.csv + GameColors.cs）"
    - "マリオカート風カウントダウン（3,2,1,さばけ！）"
    - "包丁スプライト（進行方向に回転）"
    - "包丁軌跡エフェクト（TrailRenderer）"
    - "紙吹雪パーティクル（全ブロック破壊時）"
    - "骨背景画像表示（脱衣ブロック崩し方式）"
    - "画面リサイズ対応（壁の自動再配置）"
    - "フィールド枠線表示（まないた色の縦線）"
    - "きりみアイテム（kirimi.png、当たり判定拡大）"
    - "マルチボールゲージシステム（円形UI）"
    - "サブボール生成（色違い包丁）"

  recently_completed:
    - "色設定CSV化（ColorData.csv + GameColors.cs改修）"
    - "パドルをまないた色に変更"
    - "フィールド左右に縦線の壁を表示"
    - "きりみ表示を右下からライフの下に移動"
    - "ライフ表示簡略化（♥のみ）"
    - "きりみ画像生成・適用（kirimi.png）"
    - "きりみの当たり判定拡大（radius 1.5）"
    - "「クリックで発射！」ボタン実装"
    - "マルチボールゲージ実装（円形UI・包丁アイコン中央）"
    - "サブボール（色違い包丁）生成システム"
    - "虹色包丁画像生成スクリプト"
    - "BallHelper.cs（タグ不要のボール判定ユーティリティ）"
    - "UILayoutData.csv + UILayoutManager.cs（UI配置の外部データ化）"
    - "StageManager.cs（ステージ進行管理）"

  in_progress:
    - "マルチボール機能のテストプレイ"

# =============================================
# リソース一覧
# =============================================
resources:
  sprites:
    - path: "Resources/Sprites/sakana_normal.png"
      description: "魚画像（通常状態）- ブロックマスク用"
      size: "1155x1155"
      usage: "BrickManagerで各ブロックに分割表示"
      import_settings:
        isReadable: true
        spriteMode: 1
        filterMode: 1

    - path: "Resources/Sprites/knife.png"
      description: "包丁スプライト（Twemoji U+1F52A）"
      usage: "BallControllerでボール表示に使用、進行方向に回転"
      rotation_offset: -50  # Twemoji画像の初期向き補正

    - path: "Resources/Sprites/Knives/"
      description: "虹色包丁スプライト（6色）"
      files:
        - "knife_red.png"
        - "knife_blue.png"
        - "knife_yellow.png"
        - "knife_green.png"
        - "knife_purple.png"
        - "knife_pink.png"
      usage: "サブボール（MultiBallManager）で使用"
      generator: "Tools/generate_rainbow_knives.py"

    - path: "Resources/Sprites/bone_image.png"
      description: "骨背景画像（透過PNG）"
      usage: "BrickManagerでBONE背景として表示（脱衣ブロック崩し方式）"

  fonts:
    - path: "Resources/Fonts/Meiryo-Japanese SDF.asset"
      description: "日本語フォント（メイリオ）"
      usage: "TextMeshPro用"

  ui:
    - path: "Resources/Sprites/UI/rounded_panel.png"
      description: "角丸パネル用スプライト（96x96, 角24px, 枠線3px）"
      usage: "ResultPanel, GameOverPanel等のパネル背景"
      import_settings:
        spriteMode: 1
        spriteBorder: "24,24,24,24"  # 9-slice用
        filterMode: 1  # Bilinear

    - path: "Resources/Sprites/UI/rounded_button.png"
      description: "角丸ボタン用スプライト（64x64, 角16px, 枠線2px）"
      usage: "UI Button背景"
      import_settings:
        spriteMode: 1
        spriteBorder: "16,16,16,16"
        filterMode: 1

    - path: "Resources/Sprites/UI/rounded_panel_no_border.png"
      description: "枠線なし角丸パネル（96x96, 角24px）"
      usage: "枠線不要なパネル背景"

    - path: "Resources/RoundedButton.png"
      description: "角丸ボタン用スプライト（旧版）"
      usage: "UI Button背景"
      status: "deprecated - 新版はSprites/UI/以下"

  data:
    - path: "Resources/TextData.csv"
      description: "UIテキストデータ"
      format: "CSV (category,key,subkey,text)"
      usage: "TextDataManagerで読み込み"

    - path: "Resources/UILayoutData.csv"
      description: "UI配置データ（疎結合設計）"
      format: "CSV (element,anchorX,anchorY,pivotX,pivotY,posX,posY,width,height,fontSize,extra)"
      usage: "UILayoutManagerで読み込み、各UI要素の配置に適用"
      elements:
        - "HUD要素（Lives, Kirimi, Timer, Gauge, Pause）"
        - "パネル（Result, GameOver, Pause）"
        - "パネル内ボタン・テキスト"

    - path: "Resources/StageData.csv"
      description: "ステージ設定データ（予定）"
      format: "CSV"
      status: "未作成"

  shaders:
    - path: "Assets/Shaders/BrickClipShader.shader"
      description: "ブロッククリップ用シェーダー（現在未使用）"
      note: "Sprite.Createで代替実装済み"

# =============================================
# アーキテクチャ（疎結合設計）
# =============================================
architecture:
  design_pattern: "イベント駆動 + データ駆動アーキテクチャ"
  description: |
    各コンポーネントはGameEventsを通じて通信し、直接参照を持たない疎結合設計。
    設定データはCSVファイルで外部化し、コード変更なしで調整可能。

  data_driven_components:
    colors: "ColorData.csv → GameColors.cs"
    texts: "TextData.csv → TextDataManager.cs"
    ui_layout: "UILayoutData.csv → UILayoutManager.cs"
    stage: "StageData.csv → StageDataManager.cs（予定）"

  scripts:
    GameEvents.cs:
      role: "イベントハブ（静的クラス）"
      events:
        - "OnGameStart, OnGameOver, OnGameClear, OnGameRestart"
        - "OnBallLaunched, OnBallLost, OnBallReset"
        - "OnBrickDestroyed(int), OnKirimiChanged(int), OnLivesChanged(int)"
        - "OnTimeChanged(float), OnTimeUp"
        - "OnGamePause, OnGameResume, OnReturnToTitle"
        - "OnMultiBallGaugeChanged(int), OnSubBallSpawned(int), OnSubBallLost"

    GameState.cs:
      role: "状態管理シングルトン"
      states: ["Title", "Countdown", "Ready", "Playing", "Paused", "GameOver", "GameClear"]
      properties:
        - "Kirimi: int - スコア（切り身数）"
        - "Lives: int - 残機（デフォルト5）"
        - "RemainingTime: float - 残り時間"

    GameManager.cs:
      role: "ゲーム進行管理"
      features:
        - "タイマー更新"
        - "ポーズ機能"
        - "シーン遷移"
        - "背景色設定"

    GameColors.cs:
      role: "色設定の一元管理（静的クラス）"
      colors:
        Background: "(0.8, 0.8, 0.8) - ゲーム背景（ライトグレー）"
        PanelBackground: "(0.8, 0.8, 0.8) - パネル背景"
        ButtonBackground: "(0.8, 0.8, 0.8) - ボタン背景"
        ButtonBorder: "(0.6, 0.6, 0.6) - ボタン枠線"
        TextBlack: "(0.1, 0.1, 0.1) - 通常テキスト"
        TextRed: "(0.9, 0.2, 0.2) - 強調テキスト"
        TextWhite: "白 - HUDテキスト"
        FishBody: "(1, 0.6, 0.6) - 魚の身（フォールバック）"
        FishBelly: "(1, 0.85, 0.85) - 魚の腹（フォールバック）"
        BoneBackground: "(0.8, 0.8, 0.8) - 骨背景"

    BrickManager.cs:
      role: "ブロック生成・管理"
      features:
        - "魚画像テクスチャ読み込み"
        - "画像アルファからブロックパターン自動生成"
        - "各ブロックに画像の対応部分をSprite.Createで表示"
        - "画像アスペクト比に合わせてブロックサイズ自動調整"
        - "骨背景（BONE）生成"
      settings:
        brickWidth: 0.9
        autoCenter: true
        autoAdjustToImage: true
        alphaThreshold: 0.3

    UIManager.cs:
      role: "UI制御"
      features:
        - "HUD更新（ライフ、タイマー、きりみ）"
        - "リザルト/ゲームオーバー/ポーズパネル表示"
        - "パネル・ボタンへのGameColors適用"
        - "自動UI参照機能"

    TextDataManager.cs:
      role: "テキストデータ管理"
      source: "Resources/TextData.csv"

    UILayoutManager.cs:
      role: "UI配置データ管理（シングルトン）"
      source: "Resources/UILayoutData.csv"
      features:
        - "CSVからレイアウトデータ読み込み"
        - "要素名でレイアウト取得"
        - "RectTransformへのレイアウト適用"
      methods:
        - "GetLayout(elementName): レイアウトデータ取得"
        - "ApplyLayout(rt, elementName): RectTransformに適用"

    BallController.cs:
      role: "ボール（包丁）制御"
      features:
        - "包丁スプライト表示（子オブジェクトKnifeVisual）"
        - "進行方向に合わせた包丁回転（UpdateKnifeRotation）"
        - "軌跡エフェクト（TrailRenderer）"
        - "リセット時に上向き回転"
        - "画面外検知（CheckOutOfBounds）"

    PaddleController.cs:
      role: "パドル操作"
      features:
        - "マウス/タッチ/キーボード入力"
        - "画面サイズに応じた可動域自動設定"
        - "初期位置の自動設定（画面下端からのオフセット）"

    BrickController.cs:
      role: "個別ブロック制御"

    CountdownManager.cs:
      role: "カウントダウン演出"
      features:
        - "3（黄）→ 2（オレンジ）→ 1（赤）→ さばけ！（赤）"
        - "スケールアニメーション（大→通常）"
        - "白フチ付きテキスト"

    ConfettiManager.cs:
      role: "紙吹雪パーティクル"
      features:
        - "全ブロック破壊時に発動"
        - "Unicode四角絵文字の色を使用"
        - "ランダムな落下・揺れ・回転"

    MultiBallManager.cs:
      role: "マルチボールゲージ管理（シングルトン）"
      features:
        - "ブロック破壊でゲージ増加（10で発動）"
        - "サブボール生成（虹色順）"
        - "ゲーム再開時の状態リセット"
      settings:
        gaugeMax: 10
        gaugePerBrick: 1
        subBallSpeed: 8
      events_listened:
        - "OnBrickDestroyed"
        - "OnGameRestart"
        - "OnReturnToTitle"

    SubBall.cs:
      role: "サブボール（色違い包丁）制御"
      features:
        - "パドルで打ち返し可能"
        - "ブロック破壊可能"
        - "画面外で消滅（ライフに影響なし）"
        - "進行方向に回転"
        - "軌跡エフェクト（TrailRenderer）"

    BallHelper.cs:
      role: "ボール判定ユーティリティ（静的クラス）"
      description: "タグ不要・コンポーネントベースのボール判定"
      methods:
        - "IsBall(GameObject): メイン/サブボール判定"
        - "IsBall(Collision2D): 衝突からボール判定"
        - "IsBall(Collider2D): コライダーからボール判定"
        - "IsMainBall(GameObject): メインボールのみ判定"
        - "IsSubBall(GameObject): サブボールのみ判定"
      usage: "BrickController等で使用"

    StageManager.cs:
      role: "ステージ進行管理（シングルトン・DontDestroy）"
      features:
        - "現在のステージ番号を管理"
        - "次のステージへ進む（GoToNextStage）"
        - "ステージリトライ（RetryCurrentStage）"
        - "タイトルへ戻る（GoToTitle）"
      settings:
        maxStages: 3
        gameSceneName: "SampleScene"
        titleSceneName: "TitleScene"

    WallSetup.cs:
      role: "壁の自動配置"
      features:
        - "カメラサイズに合わせた壁位置・サイズ設定"
        - "画面リサイズ検知・壁再配置"
        - "左右マージン設定（フィールド中央配置）"
      settings:
        leftMargin: 3.5  # きりみテキストとの重なり回避
        rightMargin: 3.5  # 左右対称で中央配置
      note: "PaddleController等はWallSetupからマージン値を動的取得"

    BackgroundSetup.cs:
      role: "背景設定"
      note: "GameColors.Backgroundを使用"

# =============================================
# シーン構成
# =============================================
scenes:
  TitleScene:
    path: "Assets/Scenes/TitleScene.unity"
    status: "動作OK"
    objects:
      - "Main Camera"
      - "TitleCanvas (Canvas + TitleManager)"
      - "  └ TitleText (TextMeshProUGUI)"
      - "  └ StartButton (Button)"
      - "EventSystem"

  SampleScene:
    path: "Assets/Scenes/SampleScene.unity"
    status: "動作OK"
    objects:
      - "GameManager (GameManager + GameState + BrickManager)"
      - "Paddle (PaddleController)"
      - "Ball (BallController)"
      - "Walls (Left/Right/Top/Bottom)"
      - "GameCanvas (Canvas + UIManager)"
      - "  └ HUD (LivesText, TimerText, KirimiText, PauseButton)"
      - "  └ ResultPanel"
      - "  └ GameOverPanel"
      - "  └ PausePanel"

  ResultScene:
    path: "Assets/Scenes/ResultScene.unity"
    status: "未確認"

# =============================================
# ステージデータ構造（設計）
# =============================================
stage_data_design:
  description: |
    魚画像とブロック配置パターンをステージごとに外部データ化。
    CSVまたはScriptableObjectで管理し、BrickManagerが読み込む。

  csv_format:
    file: "Resources/StageData.csv"
    columns:
      - "stage_id: ステージID"
      - "stage_name: ステージ名"
      - "fish_image: 魚画像パス（Resources相対）"
      - "grid_cols: グリッド列数"
      - "grid_rows: グリッド行数"
      - "brick_width: ブロック幅"
      - "time_limit: 制限時間（秒）"
      - "bonus_multiplier: スコア倍率"

  example_data:
    - stage_id: 1
      stage_name: "アジ"
      fish_image: "Sprites/sakana_normal"
      grid_cols: 17
      grid_rows: 13
      brick_width: 0.9
      time_limit: 90

    - stage_id: 2
      stage_name: "サバ"
      fish_image: "Sprites/sakana_saba"
      grid_cols: 20
      grid_rows: 10
      brick_width: 0.8
      time_limit: 120

  implementation:
    StageData.cs: "ステージデータクラス"
    StageDataManager.cs: "CSVからステージデータを読み込むマネージャー"
    BrickManager_changes: "LoadStage(int stageId)メソッド追加"

# =============================================
# MCP Unity できること・できないこと
# =============================================
mcp_capabilities:
  can_do:
    - "GameObjectの作成・選択・更新"
    - "Componentの追加・更新（プロパティ設定含む）"
    - "メニューアイテムの実行（File/Save, Edit/Play等）"
    - "シーンの作成・読み込み・保存"
    - "Prefabの作成"
    - "コンソールログの取得・送信"
    - "スクリプトのリコンパイル"
    - "テストの実行"
    - "アセットをシーンに追加"
    - "RectTransform, TextMeshProUGUI等のUI設定"
    - "Outline等のUIコンポーネントの色設定"

  cannot_do:
    - "ダイアログのボタンクリック（Import TMP Resources等）"
    - "Preferences画面の直接操作"
    - "Build Settings画面の直接操作"
    - "Playモード中のゲーム操作"

# =============================================
# 技術メモ
# =============================================
technical_notes:
  unity_version: "6000.0.63f1"
  render_pipeline: "Built-in 2D"

  brick_image_masking:
    description: "脱衣ブロック崩し方式の画像マスキング"
    method: |
      1. Resources.Load<Texture2D>で魚画像を読み込む
      2. 画像サイズとグリッドから各ブロックのピクセル範囲を計算
      3. Sprite.Create(texture, rect, pivot, pixelsPerUnit)で部分スプライト作成
      4. 各ブロックのSpriteRendererに設定
    alpha_detection: |
      1. 各グリッドセルの複数ポイントでアルファ値をサンプリング
      2. 平均アルファ > 0.3 ならブロック配置
      3. これにより透明部分にはブロックが生成されない

# =============================================
# 作業ログ
# =============================================
work_log:
  - date: 2025-11-29
    action: "プロジェクト仕様書作成"

  - date: 2025-11-30
    action: "基本機能実装"

  - date: 2025-12-07
    action: "疎結合リファクタリング"
    result: "GameEvents/GameState実装完了"

  - date: 2025-12-07
    action: "Gemini設計仕様対応（さばけ！おさかな v2.0）"
    result: "魚型ブロック配置、きりみスコア、ランクシステム実装"

  - date: 2025-12-13
    action: "Start Gameボタン問題修正"

  - date: 2025-12-23
    action: "リザルト画面修正・色設定実装"
    result:
      - "GameColors.cs作成（色の一元管理）"
      - "リザルト画面のランク表示修正"
      - "UIManager.csにApplyPanelColors/ApplyButtonStyle追加"

  - date: 2025-12-24
    action: "魚画像マスク実装"
    result:
      - "sakana_normal.pngをResources/Sprites/に配置"
      - "BrickManager.csで画像を各ブロックにクリッピング表示"
      - "画像アルファからブロックパターン自動生成"
      - "画像アスペクト比に合わせたブロックサイズ自動調整"
      - "背景色をライトグレー(0.8)に統一"
      - "ボタン枠線をライトグレー(0.6)に変更"

  - date: 2025-12-24
    action: "ステージデータ外部化（進行中）"
    tasks:
      - "StageData.cs作成"
      - "StageData.csv作成"
      - "BrickManager修正"

  - date: 2025-12-25
    action: "演出強化・UIフィードバック改善"
    result:
      - "マリオカート風カウントダウン実装（CountdownManager.cs）"
      - "包丁スプライト表示・進行方向回転（BallController改修）"
      - "軌跡エフェクト2倍拡大"
      - "リザルトランクをパーセント基準に変更"
      - "全クリア時の紙吹雪パーティクル（ConfettiManager.cs）"
      - "骨背景画像表示（bone_image.png）"
      - "リザルトパネルに枠線追加"
      - "画面リサイズ対応（WallSetup改修）"
      - "包丁リセット時の上向き回転"
      - "パドル・包丁の初期位置を下方に調整"

  - date: 2026-01-07
    action: "UI画像改善（角丸パネル高品質化）"
    result:
      - "角丸パネル画像生成スクリプト作成（Tools/generate_rounded_corners.py）"
      - "アンチエイリアス付き角丸UI画像生成（4倍描画→縮小方式）"
      - "rounded_panel.png（96x96, 角24px, 枠線3px）"
      - "rounded_button.png（64x64, 角16px, 枠線2px）"
      - "rounded_panel_no_border.png（96x96, 枠線なし）"
      - "MCP Unity WSL2対応設定追加（UNITY_HOST環境変数）"
    note: |
      Unity側での設定手順:
      1. Assets/Resources/Sprites/UI/の画像をインポート
      2. Sprite Editorで Border を設定（例: L=24, R=24, T=24, B=24）
      3. ResultPanel の Image Type を 'Sliced' に設定

  - date: 2026-01-08
    action: "UI/UX大幅改善・色設定CSV化"
    result:
      - "色設定CSV化（ColorData.csv + GameColors.cs改修）"
      - "パドルをまないた色（黄土色/ベージュ）に変更"
      - "フィールド左右に縦線の壁を表示"
      - "きりみ表示を右下からライフの下に移動"
      - "ライフ表示から「ライフ：」削除（♥のみ表示）"
      - "きりみ画像生成（kirimi.png）"
      - "PowerUpItemの画像をkirimi.pngに変更"
      - "きりみの当たり判定を拡大（radius 0.5→1.5）"
      - "きりみサイズを2倍に拡大"
      - "「クリックで発射！」ボタン（白背景・黒文字・中央配置）"
    files_changed:
      - "Assets/Resources/ColorData.csv（新規）"
      - "Assets/Scripts/GameColors.cs"
      - "Assets/Scripts/WallSetup.cs"
      - "Assets/Scripts/PaddleController.cs"
      - "Assets/Scripts/UIManager.cs"
      - "Assets/Scripts/PowerUpItem.cs"
      - "Assets/Resources/Sprites/kirimi.png（新規）"
      - "Tools/generate_kirimi.py（新規）"

  - date: 2026-01-08
    action: "マルチボールゲージシステム実装"
    result:
      - "MultiBallManager.cs作成（ブロック10個破壊でサブボール生成）"
      - "SubBall.cs作成（色違い包丁、パドルで打ち返し可能）"
      - "GameEvents.csにマルチボール関連イベント追加"
      - "UIManager.csに円形ゲージUI追加（Radial360、包丁アイコン中央）"
      - "虹色包丁画像生成スクリプト（generate_rainbow_knives.py）"
      - "ゲージ色変化（水色→黄色→赤）"
    files_changed:
      - "Assets/Scripts/MultiBallManager.cs（新規）"
      - "Assets/Scripts/SubBall.cs（新規）"
      - "Assets/Scripts/GameEvents.cs"
      - "Assets/Scripts/UIManager.cs"
      - "Assets/Scripts/GameManager.cs"
      - "Tools/generate_rainbow_knives.py（新規）"
    ui_design:
      gauge_type: "円形ゲージ（Radial360）"
      gauge_position: "左上、きりみ表示の下"
      gauge_size: "60x60px"
      gauge_colors:
        - "0-4: 水色"
        - "5-7: 黄色"
        - "8-9: 赤"
      center_icon: "包丁スプライト（knife.png）"

  - date: 2026-01-08
    action: "タグ依存リファクタリング"
    result:
      - "BallHelper.cs作成（ボール判定ユーティリティ）"
      - "BrickController.csをBallHelper使用に変更"
      - "「Tag: Ball is not defined」エラー完全解消"
      - "コンポーネントベースの判定に統一"
    files_changed:
      - "Assets/Scripts/BallHelper.cs（新規）"
      - "Assets/Scripts/BrickController.cs"
      - "Assets/Scripts/MultiBallManager.cs"
    design_notes:
      before: "CompareTag(\"Ball\")でタグ依存→未定義タグでエラー"
      after: "BallHelper.IsBall()でコンポーネント判定→タグ不要"

  - date: 2026-01-08
    action: "UI配置の外部データ化（疎結合強化）"
    result:
      - "UILayoutData.csv作成（UI要素の配置データ）"
      - "UILayoutManager.cs作成（レイアウトデータ管理）"
      - "UIManager.csをデータ駆動に更新"
      - "GameManager.csにUILayoutManager初期化追加"
    files_changed:
      - "Assets/Resources/UILayoutData.csv（新規）"
      - "Assets/Scripts/UILayoutManager.cs（新規）"
      - "Assets/Scripts/UIManager.cs"
      - "Assets/Scripts/GameManager.cs"
    design_notes:
      before: "UI位置がコード内にハードコード（密結合）"
      after: "CSVからレイアウト読み込み、ApplyLayout()で適用（疎結合）"
      benefit: "UIの配置変更がコード修正不要、CSV編集のみで可能"

  - date: 2026-01-09
    action: "フィールドマージン修正・疎結合強化"
    result:
      - "WallSetup.csのマージン値を3.5fに統一（左右対称でフィールド中央配置）"
      - "PaddleController.csをWallSetupから動的にマージン取得に変更（値のハードコード排除）"
      - "「きりみ」テキストとフィールド壁の重なり解消"
    files_changed:
      - "Assets/Scripts/WallSetup.cs"
      - "Assets/Scripts/PaddleController.cs"
    design_notes:
      before: "PaddleControllerに古いマージン値(2.0f, 2.5f)がハードコード→WallSetupと不整合"
      after: "PaddleControllerがWallSetupからマージン値を動的取得→常に同期"
      benefit: "マージン値をWallSetupだけで管理、他コンポーネントは自動追従"

# =============================================
# 次回作業時の手順
# =============================================
next_actions:
  immediate:
    - "フィールドマージン修正の確認（きりみテキストと壁の重なり解消）"
    - "マルチボール機能の動作確認"

  future:
    - "マルチボール強化（サブボールの種類追加、特殊効果）"
    - "ゲームバランス調整（制限時間、ボール速度等）"
    - "新しい魚画像（サバ、タイ等）の追加"
    - "複数ステージのゲームフロー実装"
    - "ステージ選択画面作成"
    - "魚ごとの難易度調整"
    - "効果音・BGM追加"
    - "スコアランキング機能"
